# Anatomy of Isaac Lab

# 1. Objectives

In [the previous article](./S04E02_train_unitree_go2_with_isaac_lab.md), we discussed how to use Isaac Lab for simulation training of the Unitree Go2 robotic dog.

After the simulation training, a set of model parameters was generated, as known as "checkpoint". 

Then, using the model loaded with checkpoint, a Unitree Go2 robotic dog can walk freely in the simulated environment, even when subjected to external forces for pushing and pulling (simulated by quickly moving the computer mouse). If the external force is not too strong, the Unitree Go2 can keep balanced when walking in a flat or a rough ground.

Our ultimate goal is to train the robotic dog in a simulated environment to generate a checkpoint of the motion model, and then apply the motion model loaded with the checkpoint to the physical robotic dog, to enable it to walk stably in the real world, in short, our goal is "sim-to-real".

In the previous article, we trained a motion model checkpoint for the robotic dog in the Isaac Lab simulation environment. Our next task is divided into two major steps:

1. Referring to [the official tutorial of Gymnasium](https://gymnasium.farama.org/tutorials/gymnasium_basics/environment_creation/), we will write python programs to implement our own environment `env`, where the observation input and the action output do not come from the Isaac Lab simulation environment, but from the physical Unitree-Go2 robotic dog.
   
2. Referring to [the official tutorial of the Unitree robotic dog Go2](https://support.unitree.com/home/en/developer/Basic_motion_control), we will call the basic motion control APIs to receive the real-time motion status of the robotic dog, and then convert it into observations for the `env`.
   
    After then, we will use these observations as inputs for the motion model, after that convert the outputs generated by the motion model into actions, to control the robotic dog's next movements in real time.

&nbsp;
Since there are quite some content involved in these 2 tasks, we focus the subject of this article on the implementation of the first step mentioned above: to implement our own environment `env`. In the next article, we will elaborate the second step.

Specifically, the first task consists of the following sub-tasks:

1. Read the source code of Isaac Lab to obtain the range of values for observations and actions in the simulation environment, that is, `observation_space` and `action_space`.
   
2. Since the data types for observations and actions are tensors, it is necessary to understand the physical meaning of each value in the tensors, more specifically, each tensor value corresponds to which joint's what parameter of the robotic dog.
   
3. Read the source code of Isaac Lab to understand how to initialize the motion model and how to load the checkpoint.

As Isaac Lab is under rapid iterative development, for the time being, [its official tutorials](https://isaac-sim.github.io/IsaacLab/source/tutorials/index.html) are neither comprehensive nor detailed enough.

Therefore, if you want to understand Isaac Lab in depth, for now, the only way is to read its source code. 

